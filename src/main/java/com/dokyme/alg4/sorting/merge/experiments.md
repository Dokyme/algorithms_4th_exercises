# 实验题

## 2.2.23 改进

```java
Length:1000
SwitchInsertionMerge(threshold:4)(x100)	0.047000
SwitchInsertionMerge(threshold:8)(x100)	0.019000
SwitchInsertionMerge(threshold:16)(x100)	0.015000
SwitchInsertionMerge(threshold:32)(x100)	0.017000
SwitchInsertionMerge(threshold:64)(x100)	0.017000
SwitchInsertionMerge(threshold:128)(x100)	0.030000
SwitchInsertionMerge(threshold:256)(x100)	0.051000
SwitchInsertionMerge(threshold:512)(x100)	0.058000
SwitchInsertionMerge(threshold:1024)(x100)	0.096000
SwitchInsertionMerge(threshold:2048)(x100)	0.098000
SwapArrayMerge(x100)	0.013000
CheckSortedMerge(x100)	0.036000

Length:2000
SwitchInsertionMerge(threshold:4)(x100)	0.031000
SwitchInsertionMerge(threshold:8)(x100)	0.043000
SwitchInsertionMerge(threshold:16)(x100)	0.033000
SwitchInsertionMerge(threshold:32)(x100)	0.031000
SwitchInsertionMerge(threshold:64)(x100)	0.032000
SwitchInsertionMerge(threshold:128)(x100)	0.038000
SwitchInsertionMerge(threshold:256)(x100)	0.067000
SwitchInsertionMerge(threshold:512)(x100)	0.144000
SwitchInsertionMerge(threshold:1024)(x100)	0.385000
SwitchInsertionMerge(threshold:2048)(x100)	0.338000
SwapArrayMerge(x100)	0.011000
CheckSortedMerge(x100)	0.025000

Length:4000
SwitchInsertionMerge(threshold:4)(x100)	0.051000
SwitchInsertionMerge(threshold:8)(x100)	0.047000
SwitchInsertionMerge(threshold:16)(x100)	0.045000
SwitchInsertionMerge(threshold:32)(x100)	0.049000
SwitchInsertionMerge(threshold:64)(x100)	0.051000
SwitchInsertionMerge(threshold:128)(x100)	0.069000
SwitchInsertionMerge(threshold:256)(x100)	0.095000
SwitchInsertionMerge(threshold:512)(x100)	0.181000
SwitchInsertionMerge(threshold:1024)(x100)	0.293000
SwitchInsertionMerge(threshold:2048)(x100)	0.579000
SwapArrayMerge(x100)	0.025000
CheckSortedMerge(x100)	0.060000

Length:8000
SwitchInsertionMerge(threshold:4)(x100)	0.104000
SwitchInsertionMerge(threshold:8)(x100)	0.107000
SwitchInsertionMerge(threshold:16)(x100)	0.100000
SwitchInsertionMerge(threshold:32)(x100)	0.098000
SwitchInsertionMerge(threshold:64)(x100)	0.115000
SwitchInsertionMerge(threshold:128)(x100)	0.133000
SwitchInsertionMerge(threshold:256)(x100)	0.203000
SwitchInsertionMerge(threshold:512)(x100)	0.322000
SwitchInsertionMerge(threshold:1024)(x100)	0.614000
SwitchInsertionMerge(threshold:2048)(x100)	1.102000
SwapArrayMerge(x100)	0.050000
CheckSortedMerge(x100)	0.116000

Length:16000
SwitchInsertionMerge(threshold:4)(x100)	0.231000
SwitchInsertionMerge(threshold:8)(x100)	0.221000
SwitchInsertionMerge(threshold:16)(x100)	0.212000
SwitchInsertionMerge(threshold:32)(x100)	0.219000
SwitchInsertionMerge(threshold:64)(x100)	0.238000
SwitchInsertionMerge(threshold:128)(x100)	0.297000
SwitchInsertionMerge(threshold:256)(x100)	0.404000
SwitchInsertionMerge(threshold:512)(x100)	0.690000
SwitchInsertionMerge(threshold:1024)(x100)	1.174000
SwitchInsertionMerge(threshold:2048)(x100)	2.339000
SwapArrayMerge(x100)	0.105000
CheckSortedMerge(x100)	0.258000

Length:32000
SwitchInsertionMerge(threshold:4)(x100)	0.490000
SwitchInsertionMerge(threshold:8)(x100)	0.479000
SwitchInsertionMerge(threshold:16)(x100)	0.465000
SwitchInsertionMerge(threshold:32)(x100)	0.468000
SwitchInsertionMerge(threshold:64)(x100)	0.513000
SwitchInsertionMerge(threshold:128)(x100)	0.614000
SwitchInsertionMerge(threshold:256)(x100)	0.946000
SwitchInsertionMerge(threshold:512)(x100)	1.373000
SwitchInsertionMerge(threshold:1024)(x100)	2.515000
SwitchInsertionMerge(threshold:2048)(x100)	4.505000
SwapArrayMerge(x100)	0.217000
CheckSortedMerge(x100)	0.548000

Length:64000
SwitchInsertionMerge(threshold:4)(x100)	1.071000
SwitchInsertionMerge(threshold:8)(x100)	1.030000
SwitchInsertionMerge(threshold:16)(x100)	1.037000
SwitchInsertionMerge(threshold:32)(x100)	1.035000
SwitchInsertionMerge(threshold:64)(x100)	1.085000
SwitchInsertionMerge(threshold:128)(x100)	1.331000
SwitchInsertionMerge(threshold:256)(x100)	1.774000
SwitchInsertionMerge(threshold:512)(x100)	2.914000
SwitchInsertionMerge(threshold:1024)(x100)	4.852000
SwitchInsertionMerge(threshold:2048)(x100)	9.563000
SwapArrayMerge(x100)	0.459000
CheckSortedMerge(x100)	1.250000

Length:128000
SwitchInsertionMerge(threshold:4)(x100)	2.338000
SwitchInsertionMerge(threshold:8)(x100)	2.262000
SwitchInsertionMerge(threshold:16)(x100)	2.225000
SwitchInsertionMerge(threshold:32)(x100)	2.220000
SwitchInsertionMerge(threshold:64)(x100)	2.464000
SwitchInsertionMerge(threshold:128)(x100)	2.985000
SwitchInsertionMerge(threshold:256)(x100)	4.008000
SwitchInsertionMerge(threshold:512)(x100)	6.425000
SwitchInsertionMerge(threshold:1024)(x100)	10.696000
SwitchInsertionMerge(threshold:2048)(x100)	18.956000
SwapArrayMerge(x100)	0.949000
CheckSortedMerge(x100)	2.615000

Length:256000
SwitchInsertionMerge(threshold:4)(x100)	5.448000
SwitchInsertionMerge(threshold:8)(x100)	5.193000
SwitchInsertionMerge(threshold:16)(x100)	5.067000
SwitchInsertionMerge(threshold:32)(x100)	5.246000
SwitchInsertionMerge(threshold:64)(x100)	5.696000
SwitchInsertionMerge(threshold:128)(x100)	6.913000
SwitchInsertionMerge(threshold:256)(x100)	8.498000
SwitchInsertionMerge(threshold:512)(x100)	13.054000
SwitchInsertionMerge(threshold:1024)(x100)	21.252000
SwitchInsertionMerge(threshold:2048)(x100)	41.184000
SwapArrayMerge(x100)	2.039000
CheckSortedMerge(x100)	6.298000

Length:512000
SwitchInsertionMerge(threshold:4)(x100)	12.359000
SwitchInsertionMerge(threshold:8)(x100)	12.109000
SwitchInsertionMerge(threshold:16)(x100)	11.819000
SwitchInsertionMerge(threshold:32)(x100)	11.746000
SwitchInsertionMerge(threshold:64)(x100)	12.605000
SwitchInsertionMerge(threshold:128)(x100)	14.420000
SwitchInsertionMerge(threshold:256)(x100)	18.695000
SwitchInsertionMerge(threshold:512)(x100)	26.437000
SwitchInsertionMerge(threshold:1024)(x100)	45.190000
SwitchInsertionMerge(threshold:2048)(x100)	77.387000
SwapArrayMerge(x100)	4.044000
CheckSortedMerge(x100)	14.190000
```

当归并排序的子序列规模小于一个阈值时，切换到插入排序，这个方法的本质在于试图使用插入排序的快速迭代循环来替代归并排序的函数递归操作。从测试结果来看，在当前测试环境下，阈值在16-32左右时排序总时间少。

但是，通过交换待排序数组和辅助数组来减少数组元素复制操作，这个手段对于归并排序的优化更加的明显。

当然，排序算法优化程度高低仅仅影响的是所花时间的比例系数。

## 2.2.24 改进的有序测试

因为我不明白2.2.8和2.2.11中的检查数组是否有序是否有区别，因此就把题目中所说的检查有序视为比较mid前后两个元素是否满足大小关系。

## 2.2.25 多向归并排序

使用带索引的最小堆来进行多路归并。根据我实现的多路排序算法，长度为N的数组分为k路归并一次需要Nlogk的时间，因此总时间T(N)应满足：

T(N)=Nlogk+kT(N/k)

递推得到：

T(N)=k/(k-1)*logk*(n-1)+k

尝试对k求导，求极值，发现是递增的，好像没有极值。

[MultiWayMerge.java](https://github.com/Dokyme/algorithms_4th_exercises/blob/master/src/main/java/com/dokyme/alg4/sorting/merge/MultiWayMerge.java)

```java
Length:1000
MultiWayMerge(way:2)(x100)	0.085000
MultiWayMerge(way:3)(x100)	0.101000
MultiWayMerge(way:4)(x100)	0.090000
MultiWayMerge(way:5)(x100)	0.045000
MultiWayMerge(way:6)(x100)	0.028000
MultiWayMerge(way:7)(x100)	0.024000
MultiWayMerge(way:8)(x100)	0.028000
MultiWayMerge(way:9)(x100)	0.025000
MultiWayMerge(way:10)(x100)	0.017000
MultiWayMerge(way:11)(x100)	0.023000

Length:2000
MultiWayMerge(way:2)(x100)	0.072000
MultiWayMerge(way:3)(x100)	0.062000
MultiWayMerge(way:4)(x100)	0.065000
MultiWayMerge(way:5)(x100)	0.053000
MultiWayMerge(way:6)(x100)	0.060000
MultiWayMerge(way:7)(x100)	0.046000
MultiWayMerge(way:8)(x100)	0.054000
MultiWayMerge(way:9)(x100)	0.089000
MultiWayMerge(way:10)(x100)	0.095000
MultiWayMerge(way:11)(x100)	0.101000

Length:4000
MultiWayMerge(way:2)(x100)	0.254000
MultiWayMerge(way:3)(x100)	0.152000
MultiWayMerge(way:4)(x100)	0.111000
MultiWayMerge(way:5)(x100)	0.115000
MultiWayMerge(way:6)(x100)	0.118000
MultiWayMerge(way:7)(x100)	0.153000
MultiWayMerge(way:8)(x100)	0.148000
MultiWayMerge(way:9)(x100)	0.148000
MultiWayMerge(way:10)(x100)	0.099000
MultiWayMerge(way:11)(x100)	0.092000

Length:8000
MultiWayMerge(way:2)(x100)	0.290000
MultiWayMerge(way:3)(x100)	0.211000
MultiWayMerge(way:4)(x100)	0.222000
MultiWayMerge(way:5)(x100)	0.208000
MultiWayMerge(way:6)(x100)	0.173000
MultiWayMerge(way:7)(x100)	0.187000
MultiWayMerge(way:8)(x100)	0.213000
MultiWayMerge(way:9)(x100)	0.190000
MultiWayMerge(way:10)(x100)	0.177000
MultiWayMerge(way:11)(x100)	0.177000

Length:16000
MultiWayMerge(way:2)(x100)	0.845000
MultiWayMerge(way:3)(x100)	0.541000
MultiWayMerge(way:4)(x100)	0.509000
MultiWayMerge(way:5)(x100)	0.464000
MultiWayMerge(way:6)(x100)	0.512000
MultiWayMerge(way:7)(x100)	0.422000
MultiWayMerge(way:8)(x100)	0.459000
MultiWayMerge(way:9)(x100)	0.488000
MultiWayMerge(way:10)(x100)	0.443000
MultiWayMerge(way:11)(x100)	0.389000

Length:32000
MultiWayMerge(way:2)(x100)	1.178000
MultiWayMerge(way:3)(x100)	0.958000
MultiWayMerge(way:4)(x100)	1.028000
MultiWayMerge(way:5)(x100)	0.982000
MultiWayMerge(way:6)(x100)	0.883000
MultiWayMerge(way:7)(x100)	1.055000
MultiWayMerge(way:8)(x100)	0.963000
MultiWayMerge(way:9)(x100)	0.867000
MultiWayMerge(way:10)(x100)	0.926000
MultiWayMerge(way:11)(x100)	0.964000

Length:64000
MultiWayMerge(way:2)(x100)	2.786000
MultiWayMerge(way:3)(x100)	2.184000
MultiWayMerge(way:4)(x100)	1.968000
MultiWayMerge(way:5)(x100)	1.883000
MultiWayMerge(way:6)(x100)	1.934000
MultiWayMerge(way:7)(x100)	1.851000
MultiWayMerge(way:8)(x100)	2.140000
MultiWayMerge(way:9)(x100)	1.844000
MultiWayMerge(way:10)(x100)	1.822000
MultiWayMerge(way:11)(x100)	1.888000

Length:128000
MultiWayMerge(way:2)(x100)	5.680000
MultiWayMerge(way:3)(x100)	4.502000
MultiWayMerge(way:4)(x100)	5.279000
MultiWayMerge(way:5)(x100)	4.720000
MultiWayMerge(way:6)(x100)	4.304000
MultiWayMerge(way:7)(x100)	3.954000
MultiWayMerge(way:8)(x100)	4.251000
MultiWayMerge(way:9)(x100)	5.017000
MultiWayMerge(way:10)(x100)	5.618000
MultiWayMerge(way:11)(x100)	5.420000

Length:256000
MultiWayMerge(way:2)(x100)	12.049000
MultiWayMerge(way:3)(x100)	9.866000
MultiWayMerge(way:4)(x100)	12.369000
MultiWayMerge(way:5)(x100)	13.871000
MultiWayMerge(way:6)(x100)	11.005000
MultiWayMerge(way:7)(x100)	10.112000
MultiWayMerge(way:8)(x100)	11.613000
MultiWayMerge(way:9)(x100)	13.795000
MultiWayMerge(way:10)(x100)	10.299000
MultiWayMerge(way:11)(x100)	12.278000

Length:512000
MultiWayMerge(way:2)(x100)	27.362000
MultiWayMerge(way:3)(x100)	22.013000
MultiWayMerge(way:4)(x100)	24.472000
MultiWayMerge(way:5)(x100)	22.380000
MultiWayMerge(way:6)(x100)	22.648000
MultiWayMerge(way:7)(x100)	20.360000
MultiWayMerge(way:8)(x100)	23.716000
MultiWayMerge(way:9)(x100)	24.275000
MultiWayMerge(way:10)(x100)	25.634000
MultiWayMerge(way:11)(x100)	22.407000
```

通过对一些较小的数字（2-11）做测试发现似乎的确不存在一个十分显著的最优的值，只是在不同问题规模下有的值会较好一些。